models:
    Pure2D_Res16UNet33:  # 6.0 M params - 23 Mo on the GPU - ~4.8 ko/pixel at training time
        class: no3d.no3dWithViewLogitFusion
        define_constants:
            in_feat: 32
            image_in_feat: 4
        down_conv:
            image:
                down_conv:
                    module_name: ResNetDown
                    block: ResBlock
                    N: [ 0, 2, 2, 2, 2 ]
                    stride: [ 1, 2, 2, 2, 2 ]
                    kernel_size: [ 3, 4, 4, 4, 4 ]
                    padding: 1
                    down_conv_nn:
                        [
                            [ image_in_feat, in_feat ],
                            [ in_feat, in_feat ],
                            [ in_feat, 2*in_feat ],
                            [ 2*in_feat, 4*in_feat ],
                            [ 4*in_feat, 8*in_feat ],
                        ]
                up_conv:
                    module_name: ResNetUp
                    block: ResBlock
                    N: [1, 1, 1, 1]
                    stride: [ 2, 2, 2, 2 ]
                    kernel_size: [ 4, 4, 4, 4 ]
                    padding: 1
                    up_conv_nn:
                        [
                            [8*in_feat, 4*in_feat, 4*in_feat],
                            [4*in_feat, 2*in_feat, 4*in_feat],
                            [4*in_feat, in_feat, 2*in_feat],
                            [2*in_feat, in_feat, in_feat],
                        ]
                last_conv:
                    input_nc: in_feat
                    output_nc: N_CLS
                atomic_pooling:
                    module_name: BimodalCSRPool
                    mode: max
                view_pooling:
                    module_name: BimodalCSRPool
                    mode: mean
                fusion:
                    module_name: BimodalFusion
                    mode: residual
                branching_index: 0

    Pure2D_Res16UNet25:  # 4.4 M params - 17.0 Mo on the GPU - ~4.3 ko/pixel at training time
        class: no3d.no3dWithViewLogitFusion
        define_constants:
            in_feat: 32
            image_in_feat: 4
        down_conv:
            image:
                down_conv:
                    module_name: ResNetDown
                    block: ResBlock
                    N: [ 0, 1, 1, 1, 1 ]
                    stride: [ 1, 2, 2, 2, 2 ]
                    kernel_size: [ 3, 4, 4, 4, 4 ]
                    padding: 1
                    down_conv_nn:
                        [
                            [ image_in_feat, in_feat ],
                            [ in_feat, in_feat ],
                            [ in_feat, 2*in_feat ],
                            [ 2*in_feat, 4*in_feat ],
                            [ 4*in_feat, 8*in_feat ],
                        ]
                up_conv:
                    module_name: ResNetUp
                    block: ResBlock
                    N: [ 1, 1, 1, 1 ]
                    stride: [ 2, 2, 2, 2 ]
                    kernel_size: [ 4, 4, 4, 4 ]
                    padding: 1
                    up_conv_nn:
                        [
                            [ 8*in_feat, 4*in_feat, 4*in_feat ],
                            [ 4*in_feat, 2*in_feat, 4*in_feat ],
                            [ 4*in_feat, in_feat, 2*in_feat ],
                            [ 2*in_feat, in_feat, in_feat ],
                        ]
                last_conv:
                    input_nc: in_feat
                    output_nc: N_CLS
                atomic_pooling:
                    module_name: BimodalCSRPool
                    mode: max
                view_pooling:
                    module_name: BimodalCSRPool
                    mode: mean
                fusion:
                    module_name: BimodalFusion
                    mode: residual
                branching_index: 0

    Pure2D_Res16UNet33_GN_WS: # 6.0 M params - 23 Mo on the GPU - ~4.8 ko/pixel at training time
        class: no3d.no3dWithViewLogitFusion
        define_constants:
            in_feat: 32
            image_in_feat: 4
        down_conv:
            image:
                down_conv:
                    module_name: ResNetDown
                    block: ResBlock
                    N: [ 0, 2, 2, 2, 2 ]
                    stride: [ 1, 2, 2, 2, 2 ]
                    kernel_size: [ 3, 4, 4, 4, 4 ]
                    padding: 1
                    normalization: GroupNorm
                    weight_standardization: True
                    down_conv_nn:
                      [
                          [ image_in_feat, in_feat ],
                          [ in_feat, in_feat ],
                          [ in_feat, 2*in_feat ],
                          [ 2*in_feat, 4*in_feat ],
                          [ 4*in_feat, 8*in_feat ],
                      ]
                up_conv:
                    module_name: ResNetUp
                    block: ResBlock
                    N: [1, 1, 1, 1]
                    stride: [ 2, 2, 2, 2 ]
                    kernel_size: [ 4, 4, 4, 4 ]
                    padding: 1
                    normalization: GroupNorm
                    weight_standardization: True
                    up_conv_nn:
                        [
                            [8*in_feat, 4*in_feat, 4*in_feat],
                            [4*in_feat, 2*in_feat, 4*in_feat],
                            [4*in_feat, in_feat, 2*in_feat],
                            [2*in_feat, in_feat, in_feat],
                        ]
                last_conv:
                    input_nc: in_feat
                    output_nc: N_CLS
                atomic_pooling:
                    module_name: BimodalCSRPool
                    mode: max
                view_pooling:
                    module_name: BimodalCSRPool
                    mode: mean
                fusion:
                    module_name: BimodalFusion
                    mode: residual
                branching_index: 0

    Pure2D_Res16UNet25_GN_WS: # 4.4 M params - 17.0 Mo on the GPU - ~4.3 ko/pixel at training time
        class: no3d.no3dWithViewLogitFusion
        define_constants:
            in_feat: 32
            image_in_feat: 4
        down_conv:
            image:
                down_conv:
                    module_name: ResNetDown
                    block: ResBlock
                    N: [ 0, 1, 1, 1, 1 ]
                    stride: [ 1, 2, 2, 2, 2 ]
                    kernel_size: [ 3, 4, 4, 4, 4 ]
                    padding: 1
                    normalization: GroupNorm
                    weight_standardization: True
                    down_conv_nn:
                      [
                          [ image_in_feat, in_feat ],
                          [ in_feat, in_feat ],
                          [ in_feat, 2*in_feat ],
                          [ 2*in_feat, 4*in_feat ],
                          [ 4*in_feat, 8*in_feat ],
                      ]
                up_conv:
                    module_name: ResNetUp
                    block: ResBlock
                    N: [1, 1, 1, 1]
                    stride: [ 2, 2, 2, 2 ]
                    kernel_size: [ 4, 4, 4, 4 ]
                    padding: 1
                    normalization: GroupNorm
                    weight_standardization: True
                    up_conv_nn:
                        [
                            [8*in_feat, 4*in_feat, 4*in_feat],
                            [4*in_feat, 2*in_feat, 4*in_feat],
                            [4*in_feat, in_feat, 2*in_feat],
                            [2*in_feat, in_feat, in_feat],
                        ]
                last_conv:
                    input_nc: in_feat
                    output_nc: N_CLS
                atomic_pooling:
                    module_name: BimodalCSRPool
                    mode: max
                view_pooling:
                    module_name: BimodalCSRPool
                    mode: mean
                fusion:
                    module_name: BimodalFusion
                    mode: residual
                branching_index: 0