models:
    Res16UNet21-15_GN_WS:
        # 6.1 M params - 23.8 Mo on the GPU - ~7.2 ko/pixel at training time
        class: no3d.No3DLogitFusion
        define_constants:
            in_feat: 32
            in_feat_img: 4
            strided_k: 2
            strided_s: 2
            strided_p: 0
        down_conv:
            image:
                down_conv:
                    module_name: ResNetDown
                    block: ResBlock
                    normalization: GroupNorm
                    weight_standardization: True
                    N: [ 0, 2, 2, 2, 2 ]
                    stride: [ 1, strided_s, strided_s, strided_s, strided_s ]
                    kernel_size: [ 3, strided_k, strided_k, strided_k, strided_k ]
                    padding: [ 1, strided_p, strided_p, strided_p, strided_p ]
                    down_conv_nn:
                      [
                          [ in_feat_img, in_feat ],
                          [ in_feat, in_feat ],
                          [ in_feat, 2*in_feat ],
                          [ 2*in_feat, 4*in_feat ],
                          [ 4*in_feat, 8*in_feat ],
                      ]
                up_conv:
                    module_name: ResNetUp
                    block: ResBlock
                    normalization: GroupNorm
                    weight_standardization: True
                    N: 1
                    kernel_size: [ strided_k, strided_k, strided_k, strided_k, 3 ]
                    stride: [ strided_s, strided_s, strided_s, strided_s, 1 ]
                    padding: [ strided_p, strided_p, strided_p, strided_p, 1 ]
                    up_conv_nn:
                      [
                          [ 8*in_feat, 4*in_feat, 4*in_feat ],
                          [ 4*in_feat, 2*in_feat, 4*in_feat ],
                          [ 4*in_feat, in_feat, 3*in_feat ],
                          [ 3*in_feat, in_feat, 3*in_feat ],
                          [ 3*in_feat, 0, 3*in_feat ],
                      ]
                last_conv:
                    input_nc: 3*in_feat
                    output_nc: N_CLS
                atomic_pooling:
                    module_name: BimodalCSRPool
                    mode: max
                view_pooling:
                    module_name: BimodalCSRPool
                    mode: mean
                fusion:
                    module_name: BimodalFusion
                    mode: residual
                branching_index: 0


    Res16UNet21-15_GN:
        # 6.1 M params - 23.8 Mo on the GPU - ~7.2 ko/pixel at training time
        class: no3d.No3DLogitFusion
        define_constants:
            in_feat: 32
            in_feat_img: 4
            strided_k: 2
            strided_s: 2
            strided_p: 0
        down_conv:
            image:
                down_conv:
                    module_name: ResNetDown
                    block: ResBlock
                    normalization: GroupNorm
                    weight_standardization: False
                    N: [ 0, 2, 2, 2, 2 ]
                    stride: [ 1, strided_s, strided_s, strided_s, strided_s ]
                    kernel_size: [ 3, strided_k, strided_k, strided_k, strided_k ]
                    padding: [ 1, strided_p, strided_p, strided_p, strided_p ]
                    down_conv_nn:
                      [
                          [ in_feat_img, in_feat ],
                          [ in_feat, in_feat ],
                          [ in_feat, 2*in_feat ],
                          [ 2*in_feat, 4*in_feat ],
                          [ 4*in_feat, 8*in_feat ],
                      ]
                up_conv:
                    module_name: ResNetUp
                    block: ResBlock
                    normalization: GroupNorm
                    weight_standardization: False
                    N: 1
                    kernel_size: [ strided_k, strided_k, strided_k, strided_k, 3 ]
                    stride: [ strided_s, strided_s, strided_s, strided_s, 1 ]
                    padding: [ strided_p, strided_p, strided_p, strided_p, 1 ]
                    up_conv_nn:
                      [
                          [ 8*in_feat, 4*in_feat, 4*in_feat ],
                          [ 4*in_feat, 2*in_feat, 4*in_feat ],
                          [ 4*in_feat, in_feat, 3*in_feat ],
                          [ 3*in_feat, in_feat, 3*in_feat ],
                          [ 3*in_feat, 0, 3*in_feat ],
                      ]
                last_conv:
                    input_nc: 3*in_feat
                    output_nc: N_CLS
                atomic_pooling:
                    module_name: BimodalCSRPool
                    mode: max
                view_pooling:
                    module_name: BimodalCSRPool
                    mode: mean
                fusion:
                    module_name: BimodalFusion
                    mode: residual
                branching_index: 0

    Res16UNet21-15_BN:
        # 6.1 M params - 23.8 Mo on the GPU - ~7.2 ko/pixel at training time
        class: no3d.No3DLogitFusion
        define_constants:
            in_feat: 32
            in_feat_img: 4
            strided_k: 2
            strided_s: 2
            strided_p: 0
        down_conv:
            image:
                down_conv:
                    module_name: ResNetDown
                    block: ResBlock
                    normalization: BatchNorm2d
                    weight_standardization: False
                    N: [ 0, 2, 2, 2, 2 ]
                    stride: [ 1, strided_s, strided_s, strided_s, strided_s ]
                    kernel_size: [ 3, strided_k, strided_k, strided_k, strided_k ]
                    padding: [ 1, strided_p, strided_p, strided_p, strided_p ]
                    down_conv_nn:
                      [
                          [ in_feat_img, in_feat ],
                          [ in_feat, in_feat ],
                          [ in_feat, 2*in_feat ],
                          [ 2*in_feat, 4*in_feat ],
                          [ 4*in_feat, 8*in_feat ],
                      ]
                up_conv:
                    module_name: ResNetUp
                    block: ResBlock
                    normalization: BatchNorm2d
                    weight_standardization: False
                    N: 1
                    kernel_size: [ strided_k, strided_k, strided_k, strided_k, 3 ]
                    stride: [ strided_s, strided_s, strided_s, strided_s, 1 ]
                    padding: [ strided_p, strided_p, strided_p, strided_p, 1 ]
                    up_conv_nn:
                      [
                          [ 8*in_feat, 4*in_feat, 4*in_feat ],
                          [ 4*in_feat, 2*in_feat, 4*in_feat ],
                          [ 4*in_feat, in_feat, 3*in_feat ],
                          [ 3*in_feat, in_feat, 3*in_feat ],
                          [ 3*in_feat, 0, 3*in_feat ],
                      ]
                last_conv:
                    input_nc: 3*in_feat
                    output_nc: N_CLS
                atomic_pooling:
                    module_name: BimodalCSRPool
                    mode: max
                view_pooling:
                    module_name: BimodalCSRPool
                    mode: mean
                fusion:
                    module_name: BimodalFusion
                    mode: residual
                branching_index: 0
    
    Res16UNet21-15_light:
        # 6.1 M params - 23.8 Mo on the GPU - ~7.2 ko/pixel at training time
        class: no3d.No3DLogitFusion
        define_constants:
            in_feat: 32
            in_feat_img: 4
            strided_k: 2
            strided_s: 2
            strided_p: 0
        down_conv:
            image:
                down_conv:
                    module_name: ResNetDown
                    block: ResBlock
                    normalization: GroupNorm
                    weight_standardization: True
                    N: [ 0, 2, 2, 2, 2 ]
                    stride: [ 1, strided_s, strided_s, strided_s, strided_s ]
                    kernel_size: [ 3, strided_k, strided_k, strided_k, strided_k ]
                    padding: [ 1, strided_p, strided_p, strided_p, strided_p ]
                    down_conv_nn:
                      [
                          [ in_feat_img, in_feat ],
                          [ in_feat, in_feat ],
                          [ in_feat, 2*in_feat ],
                          [ 2*in_feat, 4*in_feat ],
                          [ 4*in_feat, 8*in_feat ],
                      ]
                up_conv:
                    module_name: ResNetUp
                    block: ResBlock
                    normalization: GroupNorm
                    weight_standardization: True
                    N: 1
                    kernel_size: [ strided_k, strided_k, strided_k, strided_k, 3 ]
                    stride: [ strided_s, strided_s, strided_s, strided_s, 1 ]
                    padding: [ strided_p, strided_p, strided_p, strided_p, 1 ]
                    up_conv_nn:
                      [
                          [ 8*in_feat, 4*in_feat, 4*in_feat ],
                          [ 4*in_feat, 2*in_feat, 3*in_feat ],
                          [ 3*in_feat, in_feat, 2*in_feat ],
                          [ 2*in_feat, in_feat, in_feat ],
                          [ in_feat, 0, in_feat ],
                      ]
                last_conv:
                    input_nc: in_feat
                    output_nc: N_CLS
                atomic_pooling:
                    module_name: BimodalCSRPool
                    mode: max
                view_pooling:
                    module_name: BimodalCSRPool
                    mode: mean
                fusion:
                    module_name: BimodalFusion
                    mode: residual
                branching_index: 0

    Res16UNet21-15_max:
        # 6.1 M params - 23.8 Mo on the GPU - ~7.2 ko/pixel at training time
        class: no3d.No3DFeatureFusion
        define_constants:
            in_feat: 32
            in_feat_img: 4
            strided_k: 2
            strided_s: 2
            strided_p: 0
        down_conv:
            image:
                down_conv:
                    module_name: ResNetDown
                    block: ResBlock
                    normalization: GroupNorm
                    weight_standardization: True
                    N: [ 0, 2, 2, 2, 2 ]
                    stride: [ 1, strided_s, strided_s, strided_s, strided_s ]
                    kernel_size: [ 3, strided_k, strided_k, strided_k, strided_k ]
                    padding: [ 1, strided_p, strided_p, strided_p, strided_p ]
                    down_conv_nn:
                      [
                          [ in_feat_img, in_feat ],
                          [ in_feat, in_feat ],
                          [ in_feat, 2*in_feat ],
                          [ 2*in_feat, 4*in_feat ],
                          [ 4*in_feat, 8*in_feat ],
                      ]
                up_conv:
                    module_name: ResNetUp
                    block: ResBlock
                    normalization: GroupNorm
                    weight_standardization: True
                    N: 1
                    kernel_size: [ strided_k, strided_k, strided_k, strided_k, 3 ]
                    stride: [ strided_s, strided_s, strided_s, strided_s, 1 ]
                    padding: [ strided_p, strided_p, strided_p, strided_p, 1 ]
                    up_conv_nn:
                      [
                          [ 8*in_feat, 4*in_feat, 4*in_feat ],
                          [ 4*in_feat, 2*in_feat, 4*in_feat ],
                          [ 4*in_feat, in_feat, 3*in_feat ],
                          [ 3*in_feat, in_feat, 3*in_feat ],
                          [ 3*in_feat, 0, 3*in_feat ],
                      ]
                atomic_pooling:
                    module_name: BimodalCSRPool
                    mode: max
                view_pooling:
                    module_name: BimodalCSRPool
                    mode: max
                fusion:
                    module_name: BimodalFusion
                    mode: residual
                branching_index: 0
    
    Res16UNet21-15_light_heuristic-min-dist:
        # 6.1 M params - 23.8 Mo on the GPU - ~7.2 ko/pixel at training time
        class: no3d.No3DLogitFusion
        define_constants:
            in_feat: 32
            in_feat_img: 4
            strided_k: 2
            strided_s: 2
            strided_p: 0
        down_conv:
            image:
                down_conv:
                    module_name: ResNetDown
                    block: ResBlock
                    normalization: GroupNorm
                    weight_standardization: True
                    N: [ 0, 2, 2, 2, 2 ]
                    stride: [ 1, strided_s, strided_s, strided_s, strided_s ]
                    kernel_size: [ 3, strided_k, strided_k, strided_k, strided_k ]
                    padding: [ 1, strided_p, strided_p, strided_p, strided_p ]
                    down_conv_nn:
                      [
                          [ in_feat_img, in_feat ],
                          [ in_feat, in_feat ],
                          [ in_feat, 2*in_feat ],
                          [ 2*in_feat, 4*in_feat ],
                          [ 4*in_feat, 8*in_feat ],
                      ]
                up_conv:
                    module_name: ResNetUp
                    block: ResBlock
                    normalization: GroupNorm
                    weight_standardization: True
                    N: 1
                    kernel_size: [ strided_k, strided_k, strided_k, strided_k, 3 ]
                    stride: [ strided_s, strided_s, strided_s, strided_s, 1 ]
                    padding: [ strided_p, strided_p, strided_p, strided_p, 1 ]
                    up_conv_nn:
                      [
                          [ 8*in_feat, 4*in_feat, 4*in_feat ],
                          [ 4*in_feat, 2*in_feat, 3*in_feat ],
                          [ 3*in_feat, in_feat, 2*in_feat ],
                          [ 2*in_feat, in_feat, in_feat ],
                          [ in_feat, 0, in_feat ],
                      ]
                last_conv:
                    input_nc: in_feat
                    output_nc: N_CLS
                atomic_pooling:
                    module_name: BimodalCSRPool
                    mode: max
                view_pooling:
                    module_name: HeuristicBimodalCSRPool
                    mode: min
                    feat: 'normalized_depth'
                fusion:
                    module_name: BimodalFusion
                    mode: residual
                branching_index: 0
        
    Res16UNet21-15_light_heuristic-max-orientation:
        # 6.1 M params - 23.8 Mo on the GPU - ~7.2 ko/pixel at training time
        class: no3d.No3DLogitFusion
        define_constants:
            in_feat: 32
            in_feat_img: 4
            strided_k: 2
            strided_s: 2
            strided_p: 0
        down_conv:
            image:
                down_conv:
                    module_name: ResNetDown
                    block: ResBlock
                    normalization: GroupNorm
                    weight_standardization: True
                    N: [ 0, 2, 2, 2, 2 ]
                    stride: [ 1, strided_s, strided_s, strided_s, strided_s ]
                    kernel_size: [ 3, strided_k, strided_k, strided_k, strided_k ]
                    padding: [ 1, strided_p, strided_p, strided_p, strided_p ]
                    down_conv_nn:
                      [
                          [ in_feat_img, in_feat ],
                          [ in_feat, in_feat ],
                          [ in_feat, 2*in_feat ],
                          [ 2*in_feat, 4*in_feat ],
                          [ 4*in_feat, 8*in_feat ],
                      ]
                up_conv:
                    module_name: ResNetUp
                    block: ResBlock
                    normalization: GroupNorm
                    weight_standardization: True
                    N: 1
                    kernel_size: [ strided_k, strided_k, strided_k, strided_k, 3 ]
                    stride: [ strided_s, strided_s, strided_s, strided_s, 1 ]
                    padding: [ strided_p, strided_p, strided_p, strided_p, 1 ]
                    up_conv_nn:
                      [
                          [ 8*in_feat, 4*in_feat, 4*in_feat ],
                          [ 4*in_feat, 2*in_feat, 3*in_feat ],
                          [ 3*in_feat, in_feat, 2*in_feat ],
                          [ 2*in_feat, in_feat, in_feat ],
                          [ in_feat, 0, in_feat ],
                      ]
                last_conv:
                    input_nc: in_feat
                    output_nc: N_CLS
                atomic_pooling:
                    module_name: BimodalCSRPool
                    mode: max
                view_pooling:
                    module_name: HeuristicBimodalCSRPool
                    mode: max
                    feat: 'orientation_to_the_surface'
                fusion:
                    module_name: BimodalFusion
                    mode: residual
                branching_index: 0
                
    Res16UNet21-15_light_drop-30:
        # 6.1 M params - 23.8 Mo on the GPU - ~7.2 ko/pixel at training time
        class: no3d.No3DLogitFusion
        define_constants:
            in_feat: 32
            in_feat_img: 4
            strided_k: 2
            strided_s: 2
            strided_p: 0
        down_conv:
            image:
                down_conv:
                    module_name: ResNetDown
                    block: ResBlock
                    normalization: GroupNorm
                    weight_standardization: True
                    N: [ 0, 2, 2, 2, 2 ]
                    stride: [ 1, strided_s, strided_s, strided_s, strided_s ]
                    kernel_size: [ 3, strided_k, strided_k, strided_k, strided_k ]
                    padding: [ 1, strided_p, strided_p, strided_p, strided_p ]
                    down_conv_nn:
                      [
                          [ in_feat_img, in_feat ],
                          [ in_feat, in_feat ],
                          [ in_feat, 2*in_feat ],
                          [ 2*in_feat, 4*in_feat ],
                          [ 4*in_feat, 8*in_feat ],
                      ]
                up_conv:
                    module_name: ResNetUp
                    block: ResBlock
                    normalization: GroupNorm
                    weight_standardization: True
                    N: 1
                    kernel_size: [ strided_k, strided_k, strided_k, strided_k, 3 ]
                    stride: [ strided_s, strided_s, strided_s, strided_s, 1 ]
                    padding: [ strided_p, strided_p, strided_p, strided_p, 1 ]
                    up_conv_nn:
                      [
                          [ 8*in_feat, 4*in_feat, 4*in_feat ],
                          [ 4*in_feat, 2*in_feat, 3*in_feat ],
                          [ 3*in_feat, in_feat, 2*in_feat ],
                          [ 2*in_feat, in_feat, in_feat ],
                          [ in_feat, 0, in_feat ],
                      ]
                last_conv:
                    input_nc: in_feat
                    output_nc: N_CLS
                atomic_pooling:
                    module_name: BimodalCSRPool
                    mode: max
                view_pooling:
                    module_name: BimodalCSRPool
                    mode: mean
                fusion:
                    module_name: BimodalFusion
                    mode: residual
                drop_mod: 0.3
                branching_index: 0

    Res16UNet21-15_light_drop-50:
        # 6.1 M params - 23.8 Mo on the GPU - ~7.2 ko/pixel at training time
        class: no3d.No3DLogitFusion
        define_constants:
            in_feat: 32
            in_feat_img: 4
            strided_k: 2
            strided_s: 2
            strided_p: 0
        down_conv:
            image:
                down_conv:
                    module_name: ResNetDown
                    block: ResBlock
                    normalization: GroupNorm
                    weight_standardization: True
                    N: [ 0, 2, 2, 2, 2 ]
                    stride: [ 1, strided_s, strided_s, strided_s, strided_s ]
                    kernel_size: [ 3, strided_k, strided_k, strided_k, strided_k ]
                    padding: [ 1, strided_p, strided_p, strided_p, strided_p ]
                    down_conv_nn:
                      [
                          [ in_feat_img, in_feat ],
                          [ in_feat, in_feat ],
                          [ in_feat, 2*in_feat ],
                          [ 2*in_feat, 4*in_feat ],
                          [ 4*in_feat, 8*in_feat ],
                      ]
                up_conv:
                    module_name: ResNetUp
                    block: ResBlock
                    normalization: GroupNorm
                    weight_standardization: True
                    N: 1
                    kernel_size: [ strided_k, strided_k, strided_k, strided_k, 3 ]
                    stride: [ strided_s, strided_s, strided_s, strided_s, 1 ]
                    padding: [ strided_p, strided_p, strided_p, strided_p, 1 ]
                    up_conv_nn:
                      [
                          [ 8*in_feat, 4*in_feat, 4*in_feat ],
                          [ 4*in_feat, 2*in_feat, 3*in_feat ],
                          [ 3*in_feat, in_feat, 2*in_feat ],
                          [ 2*in_feat, in_feat, in_feat ],
                          [ in_feat, 0, in_feat ],
                      ]
                last_conv:
                    input_nc: in_feat
                    output_nc: N_CLS
                atomic_pooling:
                    module_name: BimodalCSRPool
                    mode: max
                view_pooling:
                    module_name: BimodalCSRPool
                    mode: mean
                fusion:
                    module_name: BimodalFusion
                    mode: residual
                drop_mod: 0.5
                branching_index: 0
    
    Res16UNet21-15_light_image-view-loss:
        # 6.1 M params - 23.8 Mo on the GPU - ~7.2 ko/pixel at training time
        class: no3d.No3DImageLogitFusion
        define_constants:
            in_feat: 32
            in_feat_img: 4
            strided_k: 2
            strided_s: 2
            strided_p: 0
        down_conv:
            image:
                down_conv:
                    module_name: ResNetDown
                    block: ResBlock
                    normalization: GroupNorm
                    weight_standardization: True
                    N: [ 0, 2, 2, 2, 2 ]
                    stride: [ 1, strided_s, strided_s, strided_s, strided_s ]
                    kernel_size: [ 3, strided_k, strided_k, strided_k, strided_k ]
                    padding: [ 1, strided_p, strided_p, strided_p, strided_p ]
                    down_conv_nn:
                      [
                          [ in_feat_img, in_feat ],
                          [ in_feat, in_feat ],
                          [ in_feat, 2*in_feat ],
                          [ 2*in_feat, 4*in_feat ],
                          [ 4*in_feat, 8*in_feat ],
                      ]
                up_conv:
                    module_name: ResNetUp
                    block: ResBlock
                    normalization: GroupNorm
                    weight_standardization: True
                    N: 1
                    kernel_size: [ strided_k, strided_k, strided_k, strided_k, 3 ]
                    stride: [ strided_s, strided_s, strided_s, strided_s, 1 ]
                    padding: [ strided_p, strided_p, strided_p, strided_p, 1 ]
                    up_conv_nn:
                      [
                          [ 8*in_feat, 4*in_feat, 4*in_feat ],
                          [ 4*in_feat, 2*in_feat, 3*in_feat ],
                          [ 3*in_feat, in_feat, 2*in_feat ],
                          [ 2*in_feat, in_feat, in_feat ],
                          [ in_feat, 0, in_feat ],
                      ]
                last_conv:
                    input_nc: in_feat
                    output_nc: N_CLS
                atomic_pooling:
                    module_name: BimodalCSRPool
                    mode: max
                view_pooling:
                    module_name: BimodalCSRPool
                    mode: mean
                fusion:
                    module_name: BimodalFusion
                    mode: residual
                keep_last_view: True
                branching_index: 0
                
    Res16UNet21-15_light_drop-10_image-view-loss:
        # 6.1 M params - 23.8 Mo on the GPU - ~7.2 ko/pixel at training time
        class: no3d.No3DImageLogitFusion
        define_constants:
            in_feat: 32
            in_feat_img: 4
            strided_k: 2
            strided_s: 2
            strided_p: 0
        down_conv:
            image:
                down_conv:
                    module_name: ResNetDown
                    block: ResBlock
                    normalization: GroupNorm
                    weight_standardization: True
                    N: [ 0, 2, 2, 2, 2 ]
                    stride: [ 1, strided_s, strided_s, strided_s, strided_s ]
                    kernel_size: [ 3, strided_k, strided_k, strided_k, strided_k ]
                    padding: [ 1, strided_p, strided_p, strided_p, strided_p ]
                    down_conv_nn:
                      [
                          [ in_feat_img, in_feat ],
                          [ in_feat, in_feat ],
                          [ in_feat, 2*in_feat ],
                          [ 2*in_feat, 4*in_feat ],
                          [ 4*in_feat, 8*in_feat ],
                      ]
                up_conv:
                    module_name: ResNetUp
                    block: ResBlock
                    normalization: GroupNorm
                    weight_standardization: True
                    N: 1
                    kernel_size: [ strided_k, strided_k, strided_k, strided_k, 3 ]
                    stride: [ strided_s, strided_s, strided_s, strided_s, 1 ]
                    padding: [ strided_p, strided_p, strided_p, strided_p, 1 ]
                    up_conv_nn:
                      [
                          [ 8*in_feat, 4*in_feat, 4*in_feat ],
                          [ 4*in_feat, 2*in_feat, 3*in_feat ],
                          [ 3*in_feat, in_feat, 2*in_feat ],
                          [ 2*in_feat, in_feat, in_feat ],
                          [ in_feat, 0, in_feat ],
                      ]
                last_conv:
                    input_nc: in_feat
                    output_nc: N_CLS
                atomic_pooling:
                    module_name: BimodalCSRPool
                    mode: max
                view_pooling:
                    module_name: BimodalCSRPool
                    mode: mean
                fusion:
                    module_name: BimodalFusion
                    mode: residual
                drop_mod: 0.1
                keep_last_view: True
                branching_index: 0

    Res16UNet21-15_light_drop-20_image-view-loss:
        # 6.1 M params - 23.8 Mo on the GPU - ~7.2 ko/pixel at training time
        class: no3d.No3DImageLogitFusion
        define_constants:
            in_feat: 32
            in_feat_img: 4
            strided_k: 2
            strided_s: 2
            strided_p: 0
        down_conv:
            image:
                down_conv:
                    module_name: ResNetDown
                    block: ResBlock
                    normalization: GroupNorm
                    weight_standardization: True
                    N: [ 0, 2, 2, 2, 2 ]
                    stride: [ 1, strided_s, strided_s, strided_s, strided_s ]
                    kernel_size: [ 3, strided_k, strided_k, strided_k, strided_k ]
                    padding: [ 1, strided_p, strided_p, strided_p, strided_p ]
                    down_conv_nn:
                      [
                          [ in_feat_img, in_feat ],
                          [ in_feat, in_feat ],
                          [ in_feat, 2*in_feat ],
                          [ 2*in_feat, 4*in_feat ],
                          [ 4*in_feat, 8*in_feat ],
                      ]
                up_conv:
                    module_name: ResNetUp
                    block: ResBlock
                    normalization: GroupNorm
                    weight_standardization: True
                    N: 1
                    kernel_size: [ strided_k, strided_k, strided_k, strided_k, 3 ]
                    stride: [ strided_s, strided_s, strided_s, strided_s, 1 ]
                    padding: [ strided_p, strided_p, strided_p, strided_p, 1 ]
                    up_conv_nn:
                      [
                          [ 8*in_feat, 4*in_feat, 4*in_feat ],
                          [ 4*in_feat, 2*in_feat, 3*in_feat ],
                          [ 3*in_feat, in_feat, 2*in_feat ],
                          [ 2*in_feat, in_feat, in_feat ],
                          [ in_feat, 0, in_feat ],
                      ]
                last_conv:
                    input_nc: in_feat
                    output_nc: N_CLS
                atomic_pooling:
                    module_name: BimodalCSRPool
                    mode: max
                view_pooling:
                    module_name: BimodalCSRPool
                    mode: mean
                fusion:
                    module_name: BimodalFusion
                    mode: residual
                drop_mod: 0.2
                keep_last_view: True
                branching_index: 0

    Res16UNet21-15_light_drop-30_image-view-loss:
        # 6.1 M params - 23.8 Mo on the GPU - ~7.2 ko/pixel at training time
        class: no3d.No3DImageLogitFusion
        define_constants:
            in_feat: 32
            in_feat_img: 4
            strided_k: 2
            strided_s: 2
            strided_p: 0
        down_conv:
            image:
                down_conv:
                    module_name: ResNetDown
                    block: ResBlock
                    normalization: GroupNorm
                    weight_standardization: True
                    N: [ 0, 2, 2, 2, 2 ]
                    stride: [ 1, strided_s, strided_s, strided_s, strided_s ]
                    kernel_size: [ 3, strided_k, strided_k, strided_k, strided_k ]
                    padding: [ 1, strided_p, strided_p, strided_p, strided_p ]
                    down_conv_nn:
                      [
                          [ in_feat_img, in_feat ],
                          [ in_feat, in_feat ],
                          [ in_feat, 2*in_feat ],
                          [ 2*in_feat, 4*in_feat ],
                          [ 4*in_feat, 8*in_feat ],
                      ]
                up_conv:
                    module_name: ResNetUp
                    block: ResBlock
                    normalization: GroupNorm
                    weight_standardization: True
                    N: 1
                    kernel_size: [ strided_k, strided_k, strided_k, strided_k, 3 ]
                    stride: [ strided_s, strided_s, strided_s, strided_s, 1 ]
                    padding: [ strided_p, strided_p, strided_p, strided_p, 1 ]
                    up_conv_nn:
                      [
                          [ 8*in_feat, 4*in_feat, 4*in_feat ],
                          [ 4*in_feat, 2*in_feat, 3*in_feat ],
                          [ 3*in_feat, in_feat, 2*in_feat ],
                          [ 2*in_feat, in_feat, in_feat ],
                          [ in_feat, 0, in_feat ],
                      ]
                last_conv:
                    input_nc: in_feat
                    output_nc: N_CLS
                atomic_pooling:
                    module_name: BimodalCSRPool
                    mode: max
                view_pooling:
                    module_name: BimodalCSRPool
                    mode: mean
                fusion:
                    module_name: BimodalFusion
                    mode: residual
                drop_mod: 0.3
                keep_last_view: True
                branching_index: 0

    Res16UNet21-15_light_drop-50_image-view-loss:
        # 6.1 M params - 23.8 Mo on the GPU - ~7.2 ko/pixel at training time
        class: no3d.No3DImageLogitFusion
        define_constants:
            in_feat: 32
            in_feat_img: 4
            strided_k: 2
            strided_s: 2
            strided_p: 0
        down_conv:
            image:
                down_conv:
                    module_name: ResNetDown
                    block: ResBlock
                    normalization: GroupNorm
                    weight_standardization: True
                    N: [ 0, 2, 2, 2, 2 ]
                    stride: [ 1, strided_s, strided_s, strided_s, strided_s ]
                    kernel_size: [ 3, strided_k, strided_k, strided_k, strided_k ]
                    padding: [ 1, strided_p, strided_p, strided_p, strided_p ]
                    down_conv_nn:
                      [
                          [ in_feat_img, in_feat ],
                          [ in_feat, in_feat ],
                          [ in_feat, 2*in_feat ],
                          [ 2*in_feat, 4*in_feat ],
                          [ 4*in_feat, 8*in_feat ],
                      ]
                up_conv:
                    module_name: ResNetUp
                    block: ResBlock
                    normalization: GroupNorm
                    weight_standardization: True
                    N: 1
                    kernel_size: [ strided_k, strided_k, strided_k, strided_k, 3 ]
                    stride: [ strided_s, strided_s, strided_s, strided_s, 1 ]
                    padding: [ strided_p, strided_p, strided_p, strided_p, 1 ]
                    up_conv_nn:
                      [
                          [ 8*in_feat, 4*in_feat, 4*in_feat ],
                          [ 4*in_feat, 2*in_feat, 3*in_feat ],
                          [ 3*in_feat, in_feat, 2*in_feat ],
                          [ 2*in_feat, in_feat, in_feat ],
                          [ in_feat, 0, in_feat ],
                      ]
                last_conv:
                    input_nc: in_feat
                    output_nc: N_CLS
                atomic_pooling:
                    module_name: BimodalCSRPool
                    mode: max
                view_pooling:
                    module_name: BimodalCSRPool
                    mode: mean
                fusion:
                    module_name: BimodalFusion
                    mode: residual
                drop_mod: 0.5
                keep_last_view: True
                branching_index: 0
                