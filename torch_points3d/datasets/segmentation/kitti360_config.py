import numpy as np
from collections import namedtuple
from torch_points3d.datasets.segmentation import IGNORE_LABEL as IGNORE


########################################################################
#                              Data splits                             #
########################################################################

WINDOWS = {
    'train': [
        '2013_05_28_drive_0000_sync/004631_004927',
        '2013_05_28_drive_0000_sync/000372_000610',
        '2013_05_28_drive_0000_sync/009886_010098',
        '2013_05_28_drive_0000_sync/007438_007605',
        '2013_05_28_drive_0000_sync/007044_007286',
        '2013_05_28_drive_0000_sync/000834_001286',
        '2013_05_28_drive_0000_sync/002501_002706',
        '2013_05_28_drive_0000_sync/010352_010588',
        '2013_05_28_drive_0000_sync/004916_005264',
        '2013_05_28_drive_0000_sync/001537_001755',
        '2013_05_28_drive_0000_sync/007277_007447',
        '2013_05_28_drive_0000_sync/003711_003928',
        '2013_05_28_drive_0000_sync/004093_004408',
        '2013_05_28_drive_0000_sync/003463_003724',
        '2013_05_28_drive_0000_sync/010830_011124',
        '2013_05_28_drive_0000_sync/008496_008790',
        '2013_05_28_drive_0000_sync/000599_000846',
        '2013_05_28_drive_0000_sync/001740_001991',
        '2013_05_28_drive_0000_sync/002913_003233',
        '2013_05_28_drive_0000_sync/002282_002514',
        '2013_05_28_drive_0000_sync/003221_003475',
        '2013_05_28_drive_0000_sync/002695_002925',
        '2013_05_28_drive_0000_sync/008278_008507',
        '2013_05_28_drive_0000_sync/005880_006165',
        '2013_05_28_drive_0000_sync/009003_009677',
        '2013_05_28_drive_0000_sync/009666_009895',
        '2013_05_28_drive_0000_sync/006387_006634',
        '2013_05_28_drive_0000_sync/006623_006851',
        '2013_05_28_drive_0000_sync/001980_002295',
        '2013_05_28_drive_0000_sync/007968_008291',
        '2013_05_28_drive_0000_sync/006828_007055',
        '2013_05_28_drive_0000_sync/010078_010362',
        '2013_05_28_drive_0000_sync/010577_010841',
        '2013_05_28_drive_0000_sync/006154_006400',
        '2013_05_28_drive_0000_sync/005249_005900',
        '2013_05_28_drive_0000_sync/011079_011287',
        '2013_05_28_drive_0000_sync/011278_011467',
        '2013_05_28_drive_0000_sync/000002_000385',
        '2013_05_28_drive_0000_sync/007596_007791',
        '2013_05_28_drive_0000_sync/008779_009015',
        '2013_05_28_drive_0000_sync/001270_001549',
        '2013_05_28_drive_0000_sync/004397_004645',
        '2013_05_28_drive_0000_sync/007777_007982',
        '2013_05_28_drive_0000_sync/003919_004105',
        '2013_05_28_drive_0002_sync/009885_010251',
        '2013_05_28_drive_0002_sync/014337_014499',
        '2013_05_28_drive_0002_sync/009049_009275',
        '2013_05_28_drive_0002_sync/006383_006769',
        '2013_05_28_drive_0002_sync/012197_012403',
        '2013_05_28_drive_0002_sync/008091_008324',
        '2013_05_28_drive_0002_sync/012378_012617',
        '2013_05_28_drive_0002_sync/008311_008656',
        '2013_05_28_drive_0002_sync/009502_009899',
        '2013_05_28_drive_0002_sync/007489_007710',
        '2013_05_28_drive_0002_sync/008645_009059',
        '2013_05_28_drive_0002_sync/007700_007935',
        '2013_05_28_drive_0002_sync/007925_008100',
        '2013_05_28_drive_0002_sync/015189_015407',
        '2013_05_28_drive_0002_sync/013652_013860',
        '2013_05_28_drive_0002_sync/011675_011894',
        '2013_05_28_drive_0002_sync/010819_011089',
        '2013_05_28_drive_0002_sync/014848_015027',
        '2013_05_28_drive_0002_sync/004613_004846',
        '2013_05_28_drive_0002_sync/010484_010836',
        '2013_05_28_drive_0002_sync/011885_012047',
        '2013_05_28_drive_0002_sync/013850_014120',
        '2013_05_28_drive_0002_sync/012607_012785',
        '2013_05_28_drive_0002_sync/011467_011684',
        '2013_05_28_drive_0002_sync/007002_007228',
        '2013_05_28_drive_0002_sync/005506_005858',
        '2013_05_28_drive_0002_sync/014106_014347',
        '2013_05_28_drive_0002_sync/009265_009515',
        '2013_05_28_drive_0002_sync/005847_006086',
        '2013_05_28_drive_0002_sync/007216_007502',
        '2013_05_28_drive_0002_sync/011082_011480',
        '2013_05_28_drive_0002_sync/004835_005136',
        '2013_05_28_drive_0002_sync/005317_005517',
        '2013_05_28_drive_0002_sync/014491_014687',
        '2013_05_28_drive_0002_sync/015540_015692',
        '2013_05_28_drive_0002_sync/015017_015199',
        '2013_05_28_drive_0002_sync/014677_014858',
        '2013_05_28_drive_0002_sync/006757_007020',
        '2013_05_28_drive_0002_sync/013409_013661',
        '2013_05_28_drive_0002_sync/006069_006398',
        '2013_05_28_drive_0002_sync/010237_010495',
        '2013_05_28_drive_0002_sync/015399_015548',
        '2013_05_28_drive_0002_sync/012776_013003',
        '2013_05_28_drive_0002_sync/004391_004625',
        '2013_05_28_drive_0002_sync/012988_013420',
        '2013_05_28_drive_0002_sync/015684_015885',
        '2013_05_28_drive_0002_sync/005125_005328',
        '2013_05_28_drive_0002_sync/012039_012206',
        '2013_05_28_drive_0003_sync/000617_000738',
        '2013_05_28_drive_0003_sync/000002_000282',
        '2013_05_28_drive_0003_sync/000508_000623',
        '2013_05_28_drive_0003_sync/000886_001009',
        '2013_05_28_drive_0003_sync/000394_000514',
        '2013_05_28_drive_0003_sync/000274_000401',
        '2013_05_28_drive_0003_sync/000731_000893',
        '2013_05_28_drive_0004_sync/007610_007773',
        '2013_05_28_drive_0004_sync/010785_011115',
        '2013_05_28_drive_0004_sync/002897_003118',
        '2013_05_28_drive_0004_sync/010010_010166',
        '2013_05_28_drive_0004_sync/006637_006868',
        '2013_05_28_drive_0004_sync/010327_010554',
        '2013_05_28_drive_0004_sync/008103_008330',
        '2013_05_28_drive_0004_sync/005466_005775',
        '2013_05_28_drive_0004_sync/003570_003975',
        '2013_05_28_drive_0004_sync/008547_008806',
        '2013_05_28_drive_0004_sync/007232_007463',
        '2013_05_28_drive_0004_sync/006306_006457',
        '2013_05_28_drive_0004_sync/003356_003586',
        '2013_05_28_drive_0004_sync/005157_005564',
        '2013_05_28_drive_0004_sync/007919_008113',
        '2013_05_28_drive_0004_sync/005765_005945',
        '2013_05_28_drive_0004_sync/004174_004380',
        '2013_05_28_drive_0004_sync/007045_007242',
        '2013_05_28_drive_0004_sync/010544_010799',
        '2013_05_28_drive_0004_sync/008320_008559',
        '2013_05_28_drive_0004_sync/004919_005171',
        '2013_05_28_drive_0004_sync/005930_006119',
        '2013_05_28_drive_0004_sync/009458_009686',
        '2013_05_28_drive_0004_sync/003107_003367',
        '2013_05_28_drive_0004_sync/008794_009042',
        '2013_05_28_drive_0004_sync/011105_011325',
        '2013_05_28_drive_0004_sync/007763_007929',
        '2013_05_28_drive_0004_sync/007449_007619',
        '2013_05_28_drive_0004_sync/009244_009469',
        '2013_05_28_drive_0004_sync/010156_010336',
        '2013_05_28_drive_0004_sync/006111_006313',
        '2013_05_28_drive_0004_sync/006857_007055',
        '2013_05_28_drive_0004_sync/003967_004185',
        '2013_05_28_drive_0004_sync/004708_004929',
        '2013_05_28_drive_0004_sync/009675_010020',
        '2013_05_28_drive_0004_sync/009026_009253',
        '2013_05_28_drive_0004_sync/004370_004726',
        '2013_05_28_drive_0004_sync/006450_006647',
        '2013_05_28_drive_0005_sync/005579_005788',
        '2013_05_28_drive_0005_sync/003245_003509',
        '2013_05_28_drive_0005_sync/002447_002823',
        '2013_05_28_drive_0005_sync/001386_001669',
        '2013_05_28_drive_0005_sync/002807_003311',
        '2013_05_28_drive_0005_sync/004549_004787',
        '2013_05_28_drive_0005_sync/004998_005335',
        '2013_05_28_drive_0005_sync/001653_001877',
        '2013_05_28_drive_0005_sync/004007_004299',
        '2013_05_28_drive_0005_sync/003501_003711',
        '2013_05_28_drive_0005_sync/000002_000357',
        '2013_05_28_drive_0005_sync/001189_001398',
        '2013_05_28_drive_0005_sync/001865_002132',
        '2013_05_28_drive_0005_sync/005777_006097',
        '2013_05_28_drive_0005_sync/000579_000958',
        '2013_05_28_drive_0005_sync/004771_005011',
        '2013_05_28_drive_0005_sync/000341_000592',
        '2013_05_28_drive_0005_sync/006298_006541',
        '2013_05_28_drive_0005_sync/004277_004566',
        '2013_05_28_drive_0005_sync/003698_004017',
        '2013_05_28_drive_0005_sync/002115_002461',
        '2013_05_28_drive_0005_sync/005324_005591',
        '2013_05_28_drive_0005_sync/000864_001199',
        '2013_05_28_drive_0005_sync/006086_006307',
        '2013_05_28_drive_0006_sync/004368_004735',
        '2013_05_28_drive_0006_sync/001208_001438',
        '2013_05_28_drive_0006_sync/007228_007465',
        '2013_05_28_drive_0006_sync/007457_007651',
        '2013_05_28_drive_0006_sync/004920_005128',
        '2013_05_28_drive_0006_sync/008271_008499',
        '2013_05_28_drive_0006_sync/001906_002133',
        '2013_05_28_drive_0006_sync/006393_006648',
        '2013_05_28_drive_0006_sync/007641_007836',
        '2013_05_28_drive_0006_sync/008898_009046',
        '2013_05_28_drive_0006_sync/004723_004930',
        '2013_05_28_drive_0006_sync/002511_002810',
        '2013_05_28_drive_0006_sync/000002_000403',
        '2013_05_28_drive_0006_sync/002124_002289',
        '2013_05_28_drive_0006_sync/001423_001711',
        '2013_05_28_drive_0006_sync/008490_008705',
        '2013_05_28_drive_0006_sync/005303_005811',
        '2013_05_28_drive_0006_sync/005107_005311',
        '2013_05_28_drive_0006_sync/006639_006827',
        '2013_05_28_drive_0006_sync/008694_008906',
        '2013_05_28_drive_0006_sync/004058_004393',
        '2013_05_28_drive_0006_sync/003001_003265',
        '2013_05_28_drive_0006_sync/005957_006191',
        '2013_05_28_drive_0006_sync/003895_004070',
        '2013_05_28_drive_0006_sync/003251_003634',
        '2013_05_28_drive_0006_sync/006177_006404',
        '2013_05_28_drive_0006_sync/000754_001010',
        '2013_05_28_drive_0006_sync/007027_007239',
        '2013_05_28_drive_0006_sync/009383_009570',
        '2013_05_28_drive_0006_sync/000387_000772',
        '2013_05_28_drive_0006_sync/001700_001916',
        '2013_05_28_drive_0006_sync/009038_009223',
        '2013_05_28_drive_0006_sync/008052_008284',
        '2013_05_28_drive_0006_sync/005801_005966',
        '2013_05_28_drive_0006_sync/007826_008063',
        '2013_05_28_drive_0006_sync/006818_007040',
        '2013_05_28_drive_0006_sync/001000_001219',
        '2013_05_28_drive_0006_sync/003613_003905',
        '2013_05_28_drive_0006_sync/009213_009393',
        '2013_05_28_drive_0006_sync/002801_003011',
        '2013_05_28_drive_0006_sync/002280_002615',
        '2013_05_28_drive_0007_sync/000002_000125',
        '2013_05_28_drive_0007_sync/002782_002902',
        '2013_05_28_drive_0007_sync/000293_000383',
        '2013_05_28_drive_0007_sync/001122_001227',
        '2013_05_28_drive_0007_sync/000208_000298',
        '2013_05_28_drive_0007_sync/001841_001957',
        '2013_05_28_drive_0007_sync/000542_000629',
        '2013_05_28_drive_0007_sync/000119_000213',
        '2013_05_28_drive_0007_sync/000624_000710',
        '2013_05_28_drive_0007_sync/001659_001750',
        '2013_05_28_drive_0007_sync/001577_001664',
        '2013_05_28_drive_0007_sync/002237_002410',
        '2013_05_28_drive_0007_sync/000705_000790',
        '2013_05_28_drive_0007_sync/001221_001348',
        '2013_05_28_drive_0007_sync/002395_002789',
        '2013_05_28_drive_0007_sync/000785_000870',
        '2013_05_28_drive_0007_sync/001034_001127',
        '2013_05_28_drive_0007_sync/000378_000466',
        '2013_05_28_drive_0007_sync/000947_001039',
        '2013_05_28_drive_0007_sync/001483_001582',
        '2013_05_28_drive_0007_sync/000865_000952',
        '2013_05_28_drive_0007_sync/001950_002251',
        '2013_05_28_drive_0007_sync/000461_000547',
        '2013_05_28_drive_0007_sync/001745_001847',
        '2013_05_28_drive_0007_sync/001340_001490',
        '2013_05_28_drive_0009_sync/011351_011646',
        '2013_05_28_drive_0009_sync/005422_005732',
        '2013_05_28_drive_0009_sync/008953_009208',
        '2013_05_28_drive_0009_sync/001234_001393',
        '2013_05_28_drive_0009_sync/012683_012899',
        '2013_05_28_drive_0009_sync/003712_003987',
        '2013_05_28_drive_0009_sync/001385_001543',
        '2013_05_28_drive_0009_sync/009195_009502',
        '2013_05_28_drive_0009_sync/002826_003034',
        '2013_05_28_drive_0009_sync/007264_007537',
        '2013_05_28_drive_0009_sync/006272_006526',
        '2013_05_28_drive_0009_sync/007838_008107',
        '2013_05_28_drive_0009_sync/003188_003457',
        '2013_05_28_drive_0009_sync/000451_000633',
        '2013_05_28_drive_0009_sync/000284_000460',
        '2013_05_28_drive_0009_sync/010703_011118',
        '2013_05_28_drive_0009_sync/013133_013380',
        '2013_05_28_drive_0009_sync/001005_001244',
        '2013_05_28_drive_0009_sync/003441_003725',
        '2013_05_28_drive_0009_sync/012167_012410',
        '2013_05_28_drive_0009_sync/000623_000787',
        '2013_05_28_drive_0009_sync/005719_005993',
        '2013_05_28_drive_0009_sync/013575_013709',
        '2013_05_28_drive_0009_sync/001534_001694',
        '2013_05_28_drive_0009_sync/001951_002126',
        '2013_05_28_drive_0009_sync/007038_007278',
        '2013_05_28_drive_0009_sync/000778_001026',
        '2013_05_28_drive_0009_sync/000002_000292',
        '2013_05_28_drive_0009_sync/005156_005440',
        '2013_05_28_drive_0009_sync/002117_002353',
        '2013_05_28_drive_0009_sync/010086_010717',
        '2013_05_28_drive_0009_sync/002615_002835',
        '2013_05_28_drive_0009_sync/009727_010097',
        '2013_05_28_drive_0009_sync/008391_008694',
        '2013_05_28_drive_0009_sync/001686_001961',
        '2013_05_28_drive_0009_sync/004905_005179',
        '2013_05_28_drive_0009_sync/008096_008413',
        '2013_05_28_drive_0009_sync/009489_009738',
        '2013_05_28_drive_0009_sync/004475_004916',
        '2013_05_28_drive_0009_sync/013701_013838',
        '2013_05_28_drive_0009_sync/003026_003200',
        '2013_05_28_drive_0009_sync/003972_004258',
        '2013_05_28_drive_0009_sync/005976_006285',
        '2013_05_28_drive_0009_sync/012398_012693',
        '2013_05_28_drive_0009_sync/011896_012181',
        '2013_05_28_drive_0009_sync/007524_007859',
        '2013_05_28_drive_0009_sync/006740_007052',
        '2013_05_28_drive_0009_sync/012876_013148',
        '2013_05_28_drive_0009_sync/002342_002630',
        '2013_05_28_drive_0009_sync/011630_011912',
        '2013_05_28_drive_0009_sync/013370_013582',
        '2013_05_28_drive_0009_sync/011099_011363',
        '2013_05_28_drive_0009_sync/004246_004489',
        '2013_05_28_drive_0009_sync/008681_008963',
        '2013_05_28_drive_0009_sync/006515_006753',
        '2013_05_28_drive_0010_sync/000199_000361',
        '2013_05_28_drive_0010_sync/002911_003114',
        '2013_05_28_drive_0010_sync/002024_002177',
        '2013_05_28_drive_0010_sync/001563_001733',
        '2013_05_28_drive_0010_sync/002756_002920',
        '2013_05_28_drive_0010_sync/003106_003313',
        '2013_05_28_drive_0010_sync/001245_001578',
        '2013_05_28_drive_0010_sync/001872_002033',
        '2013_05_28_drive_0010_sync/000002_000208',
        '2013_05_28_drive_0010_sync/002168_002765',
        '2013_05_28_drive_0010_sync/000854_000991',
        '2013_05_28_drive_0010_sync/000718_000881',
        '2013_05_28_drive_0010_sync/000549_000726',
        '2013_05_28_drive_0010_sync/001109_001252',
        '2013_05_28_drive_0010_sync/001724_001879',
        '2013_05_28_drive_0010_sync/000984_001116',
        '2013_05_28_drive_0010_sync/000353_000557'],

    # These are 3 randomly-picked windows also in train for now. Need
    # to define a true validation set with all classes represented and
    # with no overlap with train.
    'val': [
        '2013_05_28_drive_0000_sync/009886_010098',
        '2013_05_28_drive_0009_sync/001005_001244',
        '2013_05_28_drive_0010_sync/000549_000726'],

    'test': [
        '2013_05_28_drive_0008_sync/0000006988_0000007177',
        '2013_05_28_drive_0008_sync/0000000002_0000000245',
        '2013_05_28_drive_0008_sync/0000008536_0000008643',
        '2013_05_28_drive_0008_sync/0000000235_0000000608',
        '2013_05_28_drive_0008_sync/0000008417_0000008542',
        '2013_05_28_drive_0008_sync/0000004623_0000004876',
        '2013_05_28_drive_0008_sync/0000001277_0000001491',
        '2013_05_28_drive_0008_sync/0000004854_0000005104',
        '2013_05_28_drive_0008_sync/0000006792_0000006997',
        '2013_05_28_drive_0008_sync/0000002769_0000003002',
        '2013_05_28_drive_0008_sync/0000006247_0000006553',
        '2013_05_28_drive_0008_sync/0000007875_0000008100',
        '2013_05_28_drive_0008_sync/0000000812_0000001058',
        '2013_05_28_drive_0008_sync/0000007161_0000007890',
        '2013_05_28_drive_0008_sync/0000008236_0000008426',
        '2013_05_28_drive_0008_sync/0000001046_0000001295',
        '2013_05_28_drive_0008_sync/0000006517_0000006804',
        '2013_05_28_drive_0008_sync/0000005911_0000006258',
        '2013_05_28_drive_0008_sync/0000008637_0000008745',
        '2013_05_28_drive_0008_sync/0000005316_0000005605',
        '2013_05_28_drive_0008_sync/0000008090_0000008242',
        '2013_05_28_drive_0008_sync/0000005588_0000005932',
        '2013_05_28_drive_0008_sync/0000002580_0000002789',
        '2013_05_28_drive_0008_sync/0000005093_0000005329',
        '2013_05_28_drive_0008_sync/0000000581_0000000823',
        '2013_05_28_drive_0008_sync/0000002404_0000002590',
        '2013_05_28_drive_0018_sync/0000001191_0000001409',
        '2013_05_28_drive_0018_sync/0000001399_0000001587',
        '2013_05_28_drive_0018_sync/0000003503_0000003724',
        '2013_05_28_drive_0018_sync/0000002090_0000002279',
        '2013_05_28_drive_0018_sync/0000002487_0000002835',
        '2013_05_28_drive_0018_sync/0000002827_0000003047',
        '2013_05_28_drive_0018_sync/0000001577_0000001910',
        '2013_05_28_drive_0018_sync/0000000330_0000000543',
        '2013_05_28_drive_0018_sync/0000000002_0000000341',
        '2013_05_28_drive_0018_sync/0000000717_0000000985',
        '2013_05_28_drive_0018_sync/0000000530_0000000727',
        '2013_05_28_drive_0018_sync/0000000975_0000001200',
        '2013_05_28_drive_0018_sync/0000003033_0000003229',
        '2013_05_28_drive_0018_sync/0000003215_0000003513',
        '2013_05_28_drive_0018_sync/0000001878_0000002099',
        '2013_05_28_drive_0018_sync/0000002269_0000002496']}

########################################################################
#                                Labels                                #
########################################################################

# Credit: https://github.com/autonomousvision/kitti360Scripts

Label = namedtuple('Label', [

    'name',  # The identifier of this label, e.g. 'car', 'person', ... .
    # We use them to uniquely name a class

    'id',  # An integer ID that is associated with this label.
    # The IDs are used to represent the label in ground truth images
    # An ID of -1 means that this label does not have an ID and thus
    # is ignored when creating ground truth images (e.g. license plate).
    # Do not modify these IDs, since exactly these IDs are expected by the
    # evaluation server.

    'kittiId',  # An integer ID that is associated with this label for KITTI-360
    # NOT FOR RELEASING

    'trainId',  # Feel free to modify these IDs as suitable for your method. Then create
    # ground truth images with train IDs, using the tools provided in the
    # 'preparation' folder. However, make sure to validate or submit results
    # to our evaluation server using the regular IDs above!
    # For trainIds, multiple labels might have the same ID. Then, these labels
    # are mapped to the same class in the ground truth images. For the inverse
    # mapping, we use the label that is defined first in the list below.
    # For example, mapping all void-type classes to the same ID in training,
    # might make sense for some approaches.
    # Max value is 255!

    'category',  # The name of the category that this label belongs to

    'categoryId',  # The ID of this category. Used to create ground truth images
    # on category level.

    'hasInstances',  # Whether this label distinguishes between single instances or not

    'ignoreInEval',  # Whether pixels having this class as ground truth label are ignored
    # during evaluations or not

    'color',  # The color of this label
])

# A list of all labels
# NB:
#   Compared to the default KITTI360 implementation, we set all classes to be
#   ignored at train time to IGNORE. Besides, for 3D semantic segmentation, the
#   'sky' class is absent from point labels. So we discard this class from
#   training, which affects all trainIds beyond 10 compared to the default
#   KITTI360 setup.
labels = [
    # name, id, kittiId, trainId, category, catId, hasInstances, ignoreInEval, color
    Label('unlabeled', 0, -1, IGNORE, 'void', 0, False, True, (0, 0, 0)),
    Label('ego vehicle', 1, -1, IGNORE, 'void', 0, False, True, (0, 0, 0)),
    Label('rectification border', 2, -1, IGNORE, 'void', 0, False, True, (0, 0, 0)),
    Label('out of roi', 3, -1, IGNORE, 'void', 0, False, True, (0, 0, 0)),
    Label('static', 4, -1, IGNORE, 'void', 0, False, True, (0, 0, 0)),
    Label('dynamic', 5, -1, IGNORE, 'void', 0, False, True, (111, 74, 0)),
    Label('ground', 6, -1, IGNORE, 'void', 0, False, True, (81, 0, 81)),
    Label('road', 7, 1, 0, 'flat', 1, False, False, (128, 64, 128)),
    Label('sidewalk', 8, 3, 1, 'flat', 1, False, False, (244, 35, 232)),
    Label('parking', 9, 2, IGNORE, 'flat', 1, False, True, (250, 170, 160)),
    Label('rail track', 10, 10, IGNORE, 'flat', 1, False, True, (230, 150, 140)),
    Label('building', 11, 11, 2, 'construction', 2, True, False, (70, 70, 70)),
    Label('wall', 12, 7, 3, 'construction', 2, False, False, (102, 102, 156)),
    Label('fence', 13, 8, 4, 'construction', 2, False, False, (190, 153, 153)),
    Label('guard rail', 14, 30, IGNORE, 'construction', 2, False, True, (180, 165, 180)),
    Label('bridge', 15, 31, IGNORE, 'construction', 2, False, True, (150, 100, 100)),
    Label('tunnel', 16, 32, IGNORE, 'construction', 2, False, True, (150, 120, 90)),
    Label('pole', 17, 21, 5, 'object', 3, True, False, (153, 153, 153)),
    Label('polegroup', 18, -1, IGNORE, 'object', 3, False, True, (153, 153, 153)),
    Label('traffic light', 19, 23, 6, 'object', 3, True, False, (250, 170, 30)),
    Label('traffic sign', 20, 24, 7, 'object', 3, True, False, (220, 220, 0)),
    Label('vegetation', 21, 5, 8, 'nature', 4, False, False, (107, 142, 35)),
    Label('terrain', 22, 4, 9, 'nature', 4, False, False, (152, 251, 152)),
    Label('sky', 23, 9, IGNORE, 'sky', 5, False, True, (70, 130, 180)),
    Label('person', 24, 19, 10, 'human', 6, True, False, (220, 20, 60)),
    Label('rider', 25, 20, 11, 'human', 6, True, False, (255, 0, 0)),
    Label('car', 26, 13, 12, 'vehicle', 7, True, False, (0, 0, 142)),
    Label('truck', 27, 14, 13, 'vehicle', 7, True, False, (0, 0, 70)),
    Label('bus', 28, 34, 14, 'vehicle', 7, True, False, (0, 60, 100)),
    Label('caravan', 29, 16, IGNORE, 'vehicle', 7, True, True, (0, 0, 90)),
    Label('trailer', 30, 15, IGNORE, 'vehicle', 7, True, True, (0, 0, 110)),
    Label('train', 31, 33, 15, 'vehicle', 7, True, False, (0, 80, 100)),
    Label('motorcycle', 32, 17, 16, 'vehicle', 7, True, False, (0, 0, 230)),
    Label('bicycle', 33, 18, 17, 'vehicle', 7, True, False, (119, 11, 32)),
    Label('garage', 34, 12, 2, 'construction', 2, True, False, (64, 128, 128)),
    Label('gate', 35, 6, 4, 'construction', 2, False, False, (190, 153, 153)),
    Label('stop', 36, 29, IGNORE, 'construction', 2, True, True, (150, 120, 90)),
    Label('smallpole', 37, 22, 5, 'object', 3, True, False, (153, 153, 153)),
    Label('lamp', 38, 25, IGNORE, 'object', 3, True, False, (0, 64, 64)),
    Label('trash bin', 39, 26, IGNORE, 'object', 3, True, False, (0, 128, 192)),
    Label('vending machine', 40, 27, IGNORE, 'object', 3, True, False, (128, 64, 0)),
    Label('box', 41, 28, IGNORE, 'object', 3, True, False, (64, 64, 128)),
    Label('unknown construction', 42, 35, IGNORE, 'void', 0, False, True, (102, 0, 0)),
    Label('unknown vehicle', 43, 36, IGNORE, 'void', 0, False, True, (51, 0, 51)),
    Label('unknown object', 44, 37, IGNORE, 'void', 0, False, True, (32, 32, 32)),
    Label('license plate', -1, -1, -1, 'vehicle', 7, False, True, (0, 0, 142)),
]

# Dictionaries for a fast lookup
NAME2LABEL = {label.name: label for label in labels}
ID2LABEL = {label.id: label for label in labels}
TRAINID2LABEL = {label.trainId: label for label in reversed(labels)}
KITTIID2LABEL = {label.kittiId: label for label in labels}  # KITTI-360 ID to cityscapes ID
CATEGORY2LABELS = {}
for label in labels:
    category = label.category
    if category in CATEGORY2LABELS:
        CATEGORY2LABELS[category].append(label)
    else:
        CATEGORY2LABELS[category] = [label]
KITTI360_NUM_CLASSES = len(TRAINID2LABEL) - 1  # 18
INV_OBJECT_LABEL = {k: TRAINID2LABEL[k].name for k in range(KITTI360_NUM_CLASSES)}
OBJECT_COLOR = np.asarray([TRAINID2LABEL[k].color for k in range(KITTI360_NUM_CLASSES)])
OBJECT_LABEL = {name: i for i, name in INV_OBJECT_LABEL.items()}
ID2TRAINID = np.array([label.trainId for label in labels])
